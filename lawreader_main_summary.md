# `lawreader_main.py` â€” Technical Summary and Documentation

## Overview

`lawreader_main.py` is the main orchestrator for Tool 2 (LAWREADER) in the Legal AI Project. It provides a command-line and interactive interface for answering legal queries about Indian law using a hybrid approach: first leveraging a prebuilt legal knowledge graph, and then falling back to LLM-based generation if no suitable match is found in the graph. The tool also supports dynamic graph updates and answer simplification.

---

## Key Features

- **Graph-based Query Resolution:** Attempts to match user queries to existing legal scenarios in a knowledge graph for fast, context-rich answers.
- **LLM Fallback:** If no suitable scenario is found, uses a large language model (LLM) to generate new legal context and updates the graph.
- **Dynamic Graph Updates:** New scenarios, principles, and articles generated by the LLM are added to the graph, which is then re-indexed for future queries.
- **Answer Simplification:** All answers are passed through a simplifier to ensure clarity and accessibility.
- **Interactive and Batch Modes:** Supports both interactive Q&A and single-query command-line usage.
- **Debug and Statistics:** Offers debug output and graph statistics for advanced users.

---

## Main Components

- **SemanticMatcher:** Finds the closest matching scenario in the graph using semantic similarity.
- **GraphTraversal:** Expands the context of a matched scenario, retrieving related principles and articles.
- **AnswerSimplifier:** Converts complex legal context into plain-language answers.
- **AutoLinker:** Handles LLM-based generation and insertion of new nodes/edges into the graph.

---

## Core Workflow (`process_query`)

1. **Graph Matching:**
   - Attempts to find a matching scenario node in the graph using semantic similarity.
   - If found, expands context and generates a simplified answer.
2. **LLM Fallback:**
   - If no match is found (or if forced), uses the LLM to generate new legal context.
   - Updates the graph and re-indexes embeddings.
   - Expands context and generates a simplified answer from the new scenario.
3. **Result Packaging:**
   - Returns a dictionary with the answer, context, debug info, and processing time.

---

## Command-Line Usage

- **Interactive Mode:**
  ```bash
  python lawreader_main.py
  ```
- **Single Query:**
  ```bash
  python lawreader_main.py -q "Can police arrest without warrant?"
  ```
- **Force LLM:**
  ```bash
  python lawreader_main.py --force-llm -q "New legal query"
  ```
- **Adjust Similarity Threshold:**
  ```bash
  python lawreader_main.py --threshold 0.6
  ```

---

## Error Handling & Debugging
- Catches and reports initialization and processing errors.
- Debug mode prints method used, success status, processing time, and detailed debug info.
- Graph statistics (node/edge counts, types, auto-generated nodes) available via `stats` command in interactive mode.

---

## Extensibility
- Designed for easy integration with new LLMs, graph schemas, or answer simplification strategies.
- Modular architecture allows for independent upgrades of matcher, traversal, simplifier, or linker components.

---

## Example Output
```
ANSWER:
Police can arrest without a warrant in certain cases, such as when a cognizable offence is committed in their presence. [Principle: Power of arrest without warrant] [Article: Article 22 of the Constitution]

DEBUG INFO:
   Method: graph_match
   Success: True
   Time: 2.1s
   matched_scenario_id: scenario_abc123
   similarity_score: 0.82
   principles_found: 1
   articles_found: 1
```

---

## File Location
- `tool2/lawreader_main.py`

---

*This documentation was auto-generated for technical reference and onboarding.*
